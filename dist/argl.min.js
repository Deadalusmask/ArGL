!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"undefined"!=typeof self&&self,t.exports=function(t){function e(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=3)}([function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=e.Layout=function t(){r(this,t);for(var e=arguments.length,n=Array(e),a=0;a<e;a++)n[a]=arguments[a];this.attributes=n;var s=0,o=0,u=!0,l=!1,c=void 0;try{for(var h,f=n[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;if(this[d.key])throw new i(d);s%d.sizeOfType!=0&&(s+=d.sizeOfType-s%d.sizeOfType),this[d.key]={attribute:d,size:d.size,type:d.type,normalized:d.normalized,offset:s},s+=d.sizeInBytes,o=Math.max(o,d.sizeOfType)}}catch(t){l=!0,c=t}finally{try{!u&&f.return&&f.return()}finally{if(l)throw c}}s%o!=0&&(s+=o-s%o),this.stride=s;var p=!0,m=!1,M=void 0;try{for(var v,g=n[Symbol.iterator]();!(p=(v=g.next()).done);p=!0)this[v.value.key].stride=this.stride}catch(t){m=!0,M=t}finally{try{!p&&g.return&&g.return()}finally{if(m)throw M}}},i=function t(e){r(this,t),this.message="found duplicate attribute: "+e.key},s=function t(e,n,a){arguments.length>3&&void 0!==arguments[3]&&arguments[3],r(this,t),this.key=e,this.size=n,this.type=a,this.normalized=!1,this.sizeOfType=function(t){switch(a){case"BYTE":case"UNSIGNED_BYTE":return 1;case"SHORT":case"UNSIGNED_SHORT":return 2;case"FLOAT":return 4}}(),this.sizeInBytes=this.sizeOfType*n};a.POSITION=new s("position",3,"FLOAT"),a.NORMAL=new s("normal",3,"FLOAT"),a.TANGENT=new s("tangent",3,"FLOAT"),a.BITANGENT=new s("bitangent",3,"FLOAT"),a.UV=new s("uv",2,"FLOAT"),a.MATERIAL_INDEX=new s("materialIndex",1,"SHORT"),a.MATERIAL_ENABLED=new s("materialEnabled",1,"UNSIGNED_SHORT"),a.AMBIENT=new s("ambient",3,"FLOAT"),a.DIFFUSE=new s("diffuse",3,"FLOAT"),a.SPECULAR=new s("specular",3,"FLOAT"),a.SPECULAR_EXPONENT=new s("specularExponent",3,"FLOAT"),a.EMISSIVE=new s("emissive",3,"FLOAT"),a.TRANSMISSION_FILTER=new s("transmissionFilter",3,"FLOAT"),a.DISSOLVE=new s("dissolve",1,"FLOAT"),a.ILLUMINATION=new s("illumination",1,"UNSIGNED_SHORT"),a.REFRACTION_INDEX=new s("refractionIndex",1,"FLOAT"),a.SHARPNESS=new s("sharpness",1,"FLOAT"),a.MAP_DIFFUSE=new s("mapDiffuse",1,"SHORT"),a.MAP_AMBIENT=new s("mapAmbient",1,"SHORT"),a.MAP_SPECULAR=new s("mapSpecular",1,"SHORT"),a.MAP_SPECULAR_EXPONENT=new s("mapSpecularExponent",1,"SHORT"),a.MAP_DISSOLVE=new s("mapDissolve",1,"SHORT"),a.ANTI_ALIASING=new s("antiAliasing",1,"UNSIGNED_SHORT"),a.MAP_BUMP=new s("mapBump",1,"SHORT"),a.MAP_DISPLACEMENT=new s("mapDisplacement",1,"SHORT"),a.MAP_DECAL=new s("mapDecal",1,"SHORT"),a.MAP_EMISSIVE=new s("mapEmissive",1,"SHORT")},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(0),s=function(){function t(e,n){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),(n=n||{}).materials=n.materials||{},n.enableWTextureCoord=!!n.enableWTextureCoord,n.indicesPerMaterial=!!n.indicesPerMaterial;var a=this;a.vertices=[],a.vertexNormals=[],a.textures=[],a.indices=[],a.textureStride=n.enableWTextureCoord?3:2,this.name="";var i=[],s=[],o=[],u={},l=[],c={},h=-1,f=0;u.verts=[],u.norms=[],u.textures=[],u.hashindices={},u.indices=[[]],u.materialIndices=[],u.index=0;for(var d=/^v\s/,p=/^vn\s/,m=/^vt\s/,M=/^f\s/,v=/\s+/,g=/^usemtl/,b=e.split("\n"),y=0;y<b.length;y++){var x=b[y].trim();if(x&&!x.startsWith("#")){var w=x.split(v);if(w.shift(),d.test(x))i.push.apply(i,r(w));else if(p.test(x))s.push.apply(s,r(w));else if(m.test(x)){var A=w;w.length>2&&!n.enableWTextureCoord?A=w.slice(0,2):2===w.length&&n.enableWTextureCoord&&A.push(0),o.push.apply(o,r(A))}else if(g.test(x)){var T=w[0];T in c||(l.push(T),c[T]=l.length-1,n.indicesPerMaterial&&c[T]>0&&u.indices.push([])),h=c[T],n.indicesPerMaterial&&(f=h)}else if(M.test(x))for(var E=!1,I=0,k=w.length;I<k;I++){3!==I||E||(I=2,E=!0);var _=w[0]+","+h,L=w[I]+","+h;if(L in u.hashindices)u.indices[f].push(u.hashindices[L]);else{var R=w[I].split("/"),S=R.length-1;if(u.verts.push(+i[3*(R[0]-1)+0]),u.verts.push(+i[3*(R[0]-1)+1]),u.verts.push(+i[3*(R[0]-1)+2]),o.length){var F=n.enableWTextureCoord?3:2;u.textures.push(+o[(R[1]-1)*F+0]),u.textures.push(+o[(R[1]-1)*F+1]),n.enableWTextureCoord&&u.textures.push(+o[(R[1]-1)*F+2])}u.norms.push(+s[3*(R[S]-1)+0]),u.norms.push(+s[3*(R[S]-1)+1]),u.norms.push(+s[3*(R[S]-1)+2]),u.materialIndices.push(h),u.hashindices[L]=u.index,u.indices[f].push(u.hashindices[L]),u.index+=1}3===I&&E&&u.indices[f].push(u.hashindices[_])}}}a.vertices=u.verts,a.vertexNormals=u.norms,a.textures=u.textures,a.vertexMaterialIndices=u.materialIndices,a.indices=n.indicesPerMaterial?u.indices:u.indices[f],a.materialNames=l,a.materialIndices=c,a.materialsByIndex={},n.calcTangentsAndBitangents&&this.calculateTangentsAndBitangents()}return a(t,[{key:"calculateTangentsAndBitangents",value:function(){var t={};t.tangents=[].concat(r(new Array(this.vertices.length))).map(function(t){return 0}),t.bitangents=[].concat(r(new Array(this.vertices.length))).map(function(t){return 0});var e;e=Array.isArray(this.indices[0])?[].concat.apply([],this.indices):this.indices;for(var n=this.vertices,a=this.vertexNormals,i=this.textures,s=0;s<e.length;s+=3){var o=e[s+0],u=e[s+1],l=e[s+2],c=n[3*o+0],h=n[3*o+1],f=n[3*o+2],d=i[2*o+0],p=i[2*o+1],m=n[3*u+0],M=n[3*u+1],v=n[3*u+2],g=i[2*u+0],b=i[2*u+1],y=m-c,x=M-h,w=v-f,A=n[3*l+0]-c,T=n[3*l+1]-h,E=n[3*l+2]-f,I=g-d,k=b-p,_=i[2*l+0]-d,L=i[2*l+1]-p,R=I*L-k*_,S=1/(Math.abs(R<1e-4)?1:R),F=(y*L-A*k)*S,P=(x*L-T*k)*S,O=(w*L-E*k)*S,B=(A*I-y*_)*S,D=(T*I-x*_)*S,N=(E*I-w*_)*S,U=a[3*o+0],C=a[3*o+1],q=a[3*o+2],z=a[3*u+0],Y=a[3*u+1],X=a[3*u+2],V=a[3*l+0],j=a[3*l+1],W=a[3*l+2],H=F*U+P*C+O*q,G=F*z+P*Y+O*X,K=F*V+P*j+O*W,Q=F-U*H,Z=P-C*H,$=O-q*H,J=F-z*G,tt=P-Y*G,et=O-X*G,nt=F-V*K,rt=P-j*K,at=O-W*K,it=Math.sqrt(Q*Q+Z*Z+$*$),st=Math.sqrt(J*J+tt*tt+et*et),ot=Math.sqrt(nt*nt+rt*rt+at*at),ut=B*U+D*C+N*q,lt=B*z+D*Y+N*X,ct=B*V+D*j+N*W,ht=B-U*ut,ft=D-C*ut,dt=N-q*ut,pt=B-z*lt,mt=D-Y*lt,Mt=N-X*lt,vt=B-V*ct,gt=D-j*ct,bt=N-W*ct,yt=Math.sqrt(ht*ht+ft*ft+dt*dt),xt=Math.sqrt(pt*pt+mt*mt+Mt*Mt),wt=Math.sqrt(vt*vt+gt*gt+bt*bt);t.tangents[3*o+0]+=Q/it,t.tangents[3*o+1]+=Z/it,t.tangents[3*o+2]+=$/it,t.tangents[3*u+0]+=J/st,t.tangents[3*u+1]+=tt/st,t.tangents[3*u+2]+=et/st,t.tangents[3*l+0]+=nt/ot,t.tangents[3*l+1]+=rt/ot,t.tangents[3*l+2]+=at/ot,t.bitangents[3*o+0]+=ht/yt,t.bitangents[3*o+1]+=ft/yt,t.bitangents[3*o+2]+=dt/yt,t.bitangents[3*u+0]+=pt/xt,t.bitangents[3*u+1]+=mt/xt,t.bitangents[3*u+2]+=Mt/xt,t.bitangents[3*l+0]+=vt/wt,t.bitangents[3*l+1]+=gt/wt,t.bitangents[3*l+2]+=bt/wt}this.tangents=t.tangents,this.bitangents=t.bitangents}},{key:"makeBufferData",value:function(t){var e=this.vertices.length/3,n=new ArrayBuffer(t.stride*e);n.numItems=e;for(var r=new DataView(n),a=0,s=0;a<e;a++){s=a*t.stride;var o=!0,u=!1,l=void 0;try{for(var c,h=t.attributes[Symbol.iterator]();!(o=(c=h.next()).done);o=!0){var f=c.value,d=s+t[f.key].offset;switch(f.key){case i.Layout.POSITION.key:r.setFloat32(d,this.vertices[3*a],!0),r.setFloat32(d+4,this.vertices[3*a+1],!0),r.setFloat32(d+8,this.vertices[3*a+2],!0);break;case i.Layout.UV.key:r.setFloat32(d,this.textures[2*a],!0),r.setFloat32(d+4,this.vertices[2*a+1],!0);break;case i.Layout.NORMAL.key:r.setFloat32(d,this.vertexNormals[3*a],!0),r.setFloat32(d+4,this.vertexNormals[3*a+1],!0),r.setFloat32(d+8,this.vertexNormals[3*a+2],!0);break;case i.Layout.MATERIAL_INDEX.key:r.setInt16(d,this.vertexMaterialIndices[a],!0);break;case i.Layout.AMBIENT.key:var p=this.vertexMaterialIndices[a],m=this.materialsByIndex[p];if(!m)break;r.setFloat32(d,m.ambient[0],!0),r.setFloat32(d+4,m.ambient[1],!0),r.setFloat32(d+8,m.ambient[2],!0);break;case i.Layout.DIFFUSE.key:var M=this.vertexMaterialIndices[a],v=this.materialsByIndex[M];if(!v)break;r.setFloat32(d,v.diffuse[0],!0),r.setFloat32(d+4,v.diffuse[1],!0),r.setFloat32(d+8,v.diffuse[2],!0);break;case i.Layout.SPECULAR.key:var g=this.vertexMaterialIndices[a],b=this.materialsByIndex[g];if(!b)break;r.setFloat32(d,b.specular[0],!0),r.setFloat32(d+4,b.specular[1],!0),r.setFloat32(d+8,b.specular[2],!0);break;case i.Layout.SPECULAR_EXPONENT.key:var y=this.vertexMaterialIndices[a],x=this.materialsByIndex[y];if(!x)break;r.setFloat32(d,x.specularExponent,!0);break;case i.Layout.EMISSIVE.key:var w=this.vertexMaterialIndices[a],A=this.materialsByIndex[w];if(!A)break;r.setFloat32(d,A.emissive[0],!0),r.setFloat32(d+4,A.emissive[1],!0),r.setFloat32(d+8,A.emissive[2],!0);break;case i.Layout.TRANSMISSION_FILTER.key:var T=this.vertexMaterialIndices[a],E=this.materialsByIndex[T];if(!E)break;r.setFloat32(d,E.transmissionFilter[0],!0),r.setFloat32(d+4,E.transmissionFilter[1],!0),r.setFloat32(d+8,E.transmissionFilter[2],!0);break;case i.Layout.DISSOLVE.key:var I=this.vertexMaterialIndices[a],k=this.materialsByIndex[I];if(!k)break;r.setFloat32(d,k.dissolve,!0);break;case i.Layout.ILLUMINATION.key:var _=this.vertexMaterialIndices[a],L=this.materialsByIndex[_];if(!L)break;r.setInt16(d,L.illumination,!0);break;case i.Layout.REFRACTION_INDEX.key:var R=this.vertexMaterialIndices[a],S=this.materialsByIndex[R];if(!S)break;r.setFloat32(d,S.refractionIndex,!0);break;case i.Layout.SHARPNESS.key:var F=this.vertexMaterialIndices[a],P=this.materialsByIndex[F];if(!P)break;r.setFloat32(d,P.sharpness,!0);break;case i.Layout.ANTI_ALIASING.key:var O=this.vertexMaterialIndices[a],B=this.materialsByIndex[O];if(!B)break;r.setInt16(d,B.antiAliasing,!0)}}}catch(t){u=!0,l=t}finally{try{!o&&h.return&&h.return()}finally{if(u)throw l}}}return n}},{key:"makeIndexBufferData",value:function(){var t=new Uint16Array(this.indices);return t.numItems=this.indices.length,t}},{key:"addMaterialLibrary",value:function(t){for(var e in t.materials)if(e in this.materialIndices){var n=t.materials[e],r=this.materialIndices[n.name];this.materialsByIndex[r]=n}}}]),t}();e.default=s},function(t,e,n){"use strict";function r(t){return Array.isArray(t)?t:Array.from(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=e.Material=function t(e){a(this,t),this.name=e,this.ambient=[0,0,0],this.diffuse=[0,0,0],this.specular=[0,0,0],this.emissive=[0,0,0],this.transmissionFilter=[0,0,0],this.dissolve=0,this.specularExponent=0,this.transparency=0,this.illumination=0,this.refractionIndex=1,this.sharpness=0,this.mapDiffuse=null,this.mapAmbient=null,this.mapSpecular=null,this.mapSpecularExponent=null,this.mapDissolve=null,this.antiAliasing=!1,this.mapBump=null,this.mapDisplacement=null,this.mapDecal=null,this.mapEmissive=null,this.mapReflections=[]};e.MaterialLibrary=function(){function t(e){a(this,t),this.data=e,this.currentMaterial=null,this.materials={},this.parse()}return i(t,[{key:"parse_newmtl",value:function(t){var e=t[0];this.currentMaterial=new s(e),this.materials[e]=this.currentMaterial}},{key:"parseColor",value:function(t){if("spectral"!=t[0]&&"xyz"!=t[0]){if(3==t.length)return t.map(parseFloat);var e=parseFloat(t[0]);return[e,e,e]}}},{key:"parse_Ka",value:function(t){this.currentMaterial.ambient=this.parseColor(t)}},{key:"parse_Kd",value:function(t){this.currentMaterial.diffuse=this.parseColor(t)}},{key:"parse_Ks",value:function(t){this.currentMaterial.specular=this.parseColor(t)}},{key:"parse_Ke",value:function(t){this.currentMaterial.emissive=this.parseColor(t)}},{key:"parse_Tf",value:function(t){this.currentMaterial.transmissionFilter=this.parseColor(t)}},{key:"parse_d",value:function(t){this.currentMaterial.dissolve=parseFloat(t.pop())}},{key:"parse_illum",value:function(t){this.currentMaterial.illumination=parseInt(t[0])}},{key:"parse_Ni",value:function(t){this.currentMaterial.refractionIndex=parseFloat(t[0])}},{key:"parse_Ns",value:function(t){this.currentMaterial.specularExponent=parseInt(t[0])}},{key:"parse_sharpness",value:function(t){this.currentMaterial.sharpness=parseInt(t[0])}},{key:"parse_cc",value:function(t,e){e.colorCorrection="on"==t[0]}},{key:"parse_blendu",value:function(t,e){e.horizontalBlending="on"==t[0]}},{key:"parse_blendv",value:function(t,e){e.verticalBlending="on"==t[0]}},{key:"parse_boost",value:function(t,e){e.boostMipMapSharpness=parseFloat(t[0])}},{key:"parse_mm",value:function(t,e){e.modifyTextureMap.brightness=parseFloat(t[0]),e.modifyTextureMap.contrast=parseFloat(t[1])}},{key:"parse_ost",value:function(t,e,n){for(;t.length<3;)t.push(n);e.u=parseFloat(t[0]),e.v=parseFloat(t[1]),e.w=parseFloat(t[2])}},{key:"parse_o",value:function(t,e){this.parse_ost(t,e.offset,0)}},{key:"parse_s",value:function(t,e){this.parse_ost(t,e.scale,1)}},{key:"parse_t",value:function(t,e){this.parse_ost(t,e.turbulence,0)}},{key:"parse_texres",value:function(t,e){e.textureResolution=parseFloat(t[0])}},{key:"parse_clamp",value:function(t,e){e.clamp="on"==t[0]}},{key:"parse_bm",value:function(t,e){e.bumpMultiplier=parseFloat(t[0])}},{key:"parse_imfchan",value:function(t,e){e.imfChan=t[0]}},{key:"parse_type",value:function(t,e){e.reflectionType=t[0]}},{key:"parseOptions",value:function(t){var e={colorCorrection:!1,horizontalBlending:!0,verticalBlending:!0,boostMipMapSharpness:0,modifyTextureMap:{brightness:0,contrast:1},offset:{u:0,v:0,w:0},scale:{u:1,v:1,w:1},turbulence:{u:0,v:0,w:0},clamp:!1,textureResolution:null,bumpMultiplier:1,imfChan:null},n=void 0,r=void 0,a={};for(t.reverse();t.length;){var i=t.pop();i.startsWith("-")?a[n=i.substr(1)]=[]:a[n].push(i)}for(n in a)if(a.hasOwnProperty(n)){r=a[n];var s=this["parse_"+n];s&&s.bind(this)(r,e)}return e}},{key:"parseMap",value:function(t){var e=void 0,n=void 0;if(t[0].startsWith("-"))e=t.pop(),n=t;else{var a=r(t);e=a[0],n=a.slice(1)}return(n=this.parseOptions(n)).filename=e,n}},{key:"parse_map_Ka",value:function(t){this.currentMaterial.mapAmbient=this.parseMap(t)}},{key:"parse_map_Kd",value:function(t){this.currentMaterial.mapDiffuse=this.parseMap(t)}},{key:"parse_map_Ks",value:function(t){this.currentMaterial.mapSpecular=this.parseMap(t)}},{key:"parse_map_Ke",value:function(t){this.currentMaterial.mapEmissive=this.parseMap(t)}},{key:"parse_map_Ns",value:function(t){this.currentMaterial.mapSpecularExponent=this.parseMap(t)}},{key:"parse_map_d",value:function(t){this.currentMaterial.mapDissolve=this.parseMap(t)}},{key:"parse_map_aat",value:function(t){this.currentMaterial.antiAliasing="on"==t[0]}},{key:"parse_map_bump",value:function(t){this.currentMaterial.mapBump=this.parseMap(t)}},{key:"parse_bump",value:function(t){this.parse_map_bump(t)}},{key:"parse_disp",value:function(t){this.currentMaterial.mapDisplacement=this.parseMap(t)}},{key:"parse_decal",value:function(t){this.currentMaterial.mapDecal=this.parseMap(t)}},{key:"parse_refl",value:function(t){this.currentMaterial.mapReflections.push(this.parseMap(t))}},{key:"parse",value:function(){var t=this.data.split(/\r?\n/),e=!0,n=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(e=(i=s.next()).done);e=!0){var o=i.value;if((o=o.trim())&&!o.startsWith("#")){var u,l=o.split(/\s/),c=r(l);u=c[0],l=c.slice(1);var h=this["parse_"+u];h&&h.bind(this)(l)}}}catch(t){n=!0,a=t}finally{try{!e&&s.return&&s.return()}finally{if(n)throw a}}delete this.data,this.currentMaterial=null}}]),t}()},function(t,e,n){t.exports=n(4)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version=e.deleteMeshBuffers=e.initMeshBuffers=e.downloadMeshes=e.downloadModels=e.Layout=e.MaterialLibrary=e.Material=e.Mesh=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),a=n(2),i=n(0),s=n(5);e.Mesh=r.default,e.Material=a.Material,e.MaterialLibrary=a.MaterialLibrary,e.Layout=i.Layout,e.downloadModels=s.downloadModels,e.downloadMeshes=s.downloadMeshes,e.initMeshBuffers=s.initMeshBuffers,e.deleteMeshBuffers=s.deleteMeshBuffers,e.version="1.1.3"},function(t,e,n){"use strict";function r(t,e){var n=["mapDiffuse","mapAmbient","mapSpecular","mapDissolve","mapBump","mapDisplacement","mapDecal","mapEmissive"];e.endsWith("/")||(e+="/");var r=[];for(var a in t.materials)if(t.materials.hasOwnProperty(a)){a=t.materials[a];var i=!0,s=!1,o=void 0;try{for(var u,l=n[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value;!function(t){var n=a[c];if(!n)return"continue";var i=e+n.filename;r.push(fetch(i).then(function(t){if(!t.ok)throw new Error;return t.blob()}).then(function(t){var e=new Image;return e.src=URL.createObjectURL(t),n.texture=e,new Promise(function(t){return e.onload=t})}).catch(function(){}))}()}}catch(t){s=!0,o=t}finally{try{!i&&l.return&&l.return()}finally{if(s)throw o}}}return Promise.all(r)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,a=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{!r&&o.return&&o.return()}finally{if(a)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};e.downloadModels=function(t){var e=[],n=!0,o=!1,u=void 0;try{for(var l,c=t[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){!function(t){var n=[];if(!t.obj)throw new Error('"obj" attribute of model object not set. The .obj file is required to be set in order to use downloadModels()');var a={};a.indicesPerMaterial=!!t.indicesPerMaterial,a.calcTangentsAndBitangents=!!t.calcTangentsAndBitangents;var o=t.name;if(!o){var u=t.obj.split("/");o=u[u.length-1].replace(".obj","")}if(n.push(Promise.resolve(o)),n.push(fetch(t.obj).then(function(t){return t.text()}).then(function(t){return new i.default(t,a)})),t.mtl){var l=t.mtl;"boolean"==typeof l&&(l=t.obj.replace(/\.obj$/,".mtl")),n.push(fetch(l).then(function(t){return t.text()}).then(function(e){var n=new s.MaterialLibrary(e);if(!1!==t.downloadMtlTextures){var a=t.mtlTextureRoot;return a||(a=l.substr(0,l.lastIndexOf("/"))),Promise.all([Promise.resolve(n),r(n,a)])}return Promise.all(Promise.resolve(n))}).then(function(t){return t[0]}))}e.push(Promise.all(n))}(l.value)}}catch(t){o=!0,u=t}finally{try{!n&&c.return&&c.return()}finally{if(o)throw u}}return Promise.all(e).then(function(t){var e={},n=!0,r=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var u=s.value,l=a(u,3),c=l[0],h=l[1],f=l[2];h.name=c,f&&h.addMaterialLibrary(f),e[c]=h}}catch(t){r=!0,i=t}finally{try{!n&&o.return&&o.return()}finally{if(r)throw i}}return e})},e.downloadMeshes=function(t,e,n){void 0===n&&(n={});var r=[];for(var s in t)!function(e){if(!t.hasOwnProperty(e))return"continue";var n=t[e];r.push(fetch(n).then(function(t){return t.text()}).then(function(t){return[e,new i.default(t)]}))}(s);Promise.all(r).then(function(t){var r=!0,i=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var l=o.value,c=a(l,2),h=c[0],f=c[1];n[h]=f}}catch(t){i=!0,s=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw s}}return e(n)})},e.initMeshBuffers=function(t,e){e.normalBuffer=o(t,t.ARRAY_BUFFER,e.vertexNormals,3),e.textureBuffer=o(t,t.ARRAY_BUFFER,e.textures,e.textureStride),e.vertexBuffer=o(t,t.ARRAY_BUFFER,e.vertices,3),e.indexBuffer=o(t,t.ELEMENT_ARRAY_BUFFER,e.indices,1)},e.deleteMeshBuffers=function(t,e){t.deleteBuffer(e.normalBuffer),t.deleteBuffer(e.textureBuffer),t.deleteBuffer(e.vertexBuffer),t.deleteBuffer(e.indexBuffer)};var i=function(t){return t&&t.__esModule?t:{default:t}}(n(1)),s=n(2),o=(n(0),function(t,e,n,r){var a=t.createBuffer(),i=e===t.ARRAY_BUFFER?Float32Array:Uint16Array;return t.bindBuffer(e,a),t.bufferData(e,new i(n),t.STATIC_DRAW),a.itemSize=r,a.numItems=n.length/r,a})}])},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"create",function(){return m}),n.d(r,"clone",function(){return M}),n.d(r,"copy",function(){return v}),n.d(r,"fromValues",function(){return g}),n.d(r,"set",function(){return b}),n.d(r,"identity",function(){return y}),n.d(r,"transpose",function(){return x}),n.d(r,"invert",function(){return w}),n.d(r,"adjoint",function(){return A}),n.d(r,"determinant",function(){return T}),n.d(r,"multiply",function(){return E}),n.d(r,"translate",function(){return I}),n.d(r,"scale",function(){return k}),n.d(r,"rotate",function(){return _}),n.d(r,"rotateX",function(){return L}),n.d(r,"rotateY",function(){return R}),n.d(r,"rotateZ",function(){return S}),n.d(r,"fromTranslation",function(){return F}),n.d(r,"fromScaling",function(){return P}),n.d(r,"fromRotation",function(){return O}),n.d(r,"fromXRotation",function(){return B}),n.d(r,"fromYRotation",function(){return D}),n.d(r,"fromZRotation",function(){return N}),n.d(r,"fromRotationTranslation",function(){return U}),n.d(r,"fromQuat2",function(){return C}),n.d(r,"getTranslation",function(){return q}),n.d(r,"getScaling",function(){return z}),n.d(r,"getRotation",function(){return Y}),n.d(r,"fromRotationTranslationScale",function(){return X}),n.d(r,"fromRotationTranslationScaleOrigin",function(){return V}),n.d(r,"fromQuat",function(){return j}),n.d(r,"frustum",function(){return W}),n.d(r,"perspective",function(){return H}),n.d(r,"perspectiveFromFieldOfView",function(){return G}),n.d(r,"ortho",function(){return K}),n.d(r,"lookAt",function(){return Q}),n.d(r,"targetTo",function(){return Z}),n.d(r,"str",function(){return $}),n.d(r,"frob",function(){return J}),n.d(r,"add",function(){return tt}),n.d(r,"subtract",function(){return et}),n.d(r,"multiplyScalar",function(){return nt}),n.d(r,"multiplyScalarAndAdd",function(){return rt}),n.d(r,"exactEquals",function(){return at}),n.d(r,"equals",function(){return it}),n.d(r,"mul",function(){return st}),n.d(r,"sub",function(){return ot});var a={};n.r(a),n.d(a,"create",function(){return ut}),n.d(a,"clone",function(){return lt}),n.d(a,"length",function(){return ct}),n.d(a,"fromValues",function(){return ht}),n.d(a,"copy",function(){return ft}),n.d(a,"set",function(){return dt}),n.d(a,"add",function(){return pt}),n.d(a,"subtract",function(){return mt}),n.d(a,"multiply",function(){return Mt}),n.d(a,"divide",function(){return vt}),n.d(a,"ceil",function(){return gt}),n.d(a,"floor",function(){return bt}),n.d(a,"min",function(){return yt}),n.d(a,"max",function(){return xt}),n.d(a,"round",function(){return wt}),n.d(a,"scale",function(){return At}),n.d(a,"scaleAndAdd",function(){return Tt}),n.d(a,"distance",function(){return Et}),n.d(a,"squaredDistance",function(){return It}),n.d(a,"squaredLength",function(){return kt}),n.d(a,"negate",function(){return _t}),n.d(a,"inverse",function(){return Lt}),n.d(a,"normalize",function(){return Rt}),n.d(a,"dot",function(){return St}),n.d(a,"cross",function(){return Ft}),n.d(a,"lerp",function(){return Pt}),n.d(a,"hermite",function(){return Ot}),n.d(a,"bezier",function(){return Bt}),n.d(a,"random",function(){return Dt}),n.d(a,"transformMat4",function(){return Nt}),n.d(a,"transformMat3",function(){return Ut}),n.d(a,"transformQuat",function(){return Ct}),n.d(a,"rotateX",function(){return qt}),n.d(a,"rotateY",function(){return zt}),n.d(a,"rotateZ",function(){return Yt}),n.d(a,"angle",function(){return Xt}),n.d(a,"str",function(){return Vt}),n.d(a,"exactEquals",function(){return jt}),n.d(a,"equals",function(){return Wt}),n.d(a,"sub",function(){return Ht}),n.d(a,"mul",function(){return Gt}),n.d(a,"div",function(){return Kt}),n.d(a,"dist",function(){return Qt}),n.d(a,"sqrDist",function(){return Zt}),n.d(a,"len",function(){return $t}),n.d(a,"sqrLen",function(){return Jt}),n.d(a,"forEach",function(){return te});var i={};n.r(i),n.d(i,"create",function(){return ee}),n.d(i,"identity",function(){return ne}),n.d(i,"setAxisAngle",function(){return re}),n.d(i,"getAxisAngle",function(){return ae}),n.d(i,"multiply",function(){return ie}),n.d(i,"rotateX",function(){return se}),n.d(i,"rotateY",function(){return oe}),n.d(i,"rotateZ",function(){return ue}),n.d(i,"calculateW",function(){return le}),n.d(i,"slerp",function(){return ce}),n.d(i,"invert",function(){return he}),n.d(i,"conjugate",function(){return fe}),n.d(i,"fromMat3",function(){return de}),n.d(i,"fromEuler",function(){return pe}),n.d(i,"str",function(){return me}),n.d(i,"clone",function(){return Me}),n.d(i,"fromValues",function(){return ve}),n.d(i,"copy",function(){return ge}),n.d(i,"set",function(){return be}),n.d(i,"add",function(){return ye}),n.d(i,"mul",function(){return xe}),n.d(i,"scale",function(){return we}),n.d(i,"dot",function(){return Ae}),n.d(i,"lerp",function(){return Te}),n.d(i,"length",function(){return Ee}),n.d(i,"len",function(){return Ie}),n.d(i,"squaredLength",function(){return ke}),n.d(i,"sqrLen",function(){return _e}),n.d(i,"normalize",function(){return Le}),n.d(i,"exactEquals",function(){return Re}),n.d(i,"equals",function(){return Se}),n.d(i,"rotationTo",function(){return Fe}),n.d(i,"sqlerp",function(){return Pe}),n.d(i,"setAxes",function(){return Oe});var s,o=n(0);class u{constructor(t,e,n){let r=l(t,t.VERTEX_SHADER,e),a=l(t,t.FRAGMENT_SHADER,n),i=t.createProgram();if(t.attachShader(i,r),t.attachShader(i,a),t.linkProgram(i),t.deleteShader(r),t.deleteShader(a),!t.getProgramParameter(i,t.LINK_STATUS))return console.error("Unable to initialize the shader program: "+t.getProgramInfoLog(i)),null;this.gl=t,this.program=i}use(){this.gl.useProgram(this.program)}setBool(t,e){this.gl.uniform1i(this.gl.getUniformLocation(this.program,t),Number(e))}setInt(t,e){this.gl.uniform1i(this.gl.getUniformLocation(this.program,t),Math.round(Number(e)))}setFloat(t,e){this.gl.uniform1f(this.gl.getUniformLocation(this.program,t),Number(e))}setVec2(t,e){this.gl.uniform2fv(this.gl.getUniformLocation(this.program,t),e)}setVec3(t,e){this.gl.uniform3fv(this.gl.getUniformLocation(this.program,t),e)}setVec4(t,e){this.gl.uniform4fv(this.gl.getUniformLocation(this.program,t),e)}setMat2(t,e){this.gl.uniformMatrix2fv(this.gl.getUniformLocation(this.program,t),!1,e)}setMat3(t,e){this.gl.uniformMatrix3fv(this.gl.getUniformLocation(this.program,t),!1,e)}setMat4(t,e){this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.program,t),!1,e)}}function l(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:(console.error("An error occurred compiling the shaders: "+t.getShaderInfoLog(r)),t.deleteShader(r),null)}class c{constructor({width:t=300,height:e=150,desktopInput:n=!0,touchInput:r=!0}){this.options={width:t,height:e,desktopInput:n,touchInput:r},this.el=document.createElement("div"),this.canvas=document.createElement("canvas"),this.el.style.width=t.toString()+"px",this.el.style.height=e.toString()+"px",this.canvas.style.width=t.toString()+"px",this.canvas.style.height=e.toString()+"px",this.loadingBar=document.createElement("progress"),this.loadingBar.value=0,this.loadingBar.max=100,this.loadingBar.style.width=t+"px",this.el.appendChild(this.loadingBar),this.resource={images:[]},this.resourceCount=0,this.loadProgress=[];let a=this;if(this.loadProgressProxy=new Proxy(this.loadProgress,{set:function(t,e,n,r){let i=a.loadProgress.reduce((t,e)=>t+Number(e),0);return 0!==a.resourceCount&&(a.loadingBar.value=i/a.resourceCount),Reflect.set(t,e,n,r)}}),this.gl=this.canvas.getContext("webgl2"),!this.gl)return console.error("Unable to initialize WebGL2. Your browser or machine may not support it."),null;if(this.deltaTime=0,this.lastFrame=0,function(){let t=!1;var e;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t}()?this.mobile=!0:this.mobile=!1,this.options.desktopInput){let t={lockPointer:!0};"boolean"!=typeof n&&(t=this.options.desktopInput);let[e,r]=c.desktopInput(this.canvas,t);this.currentlyPressedKeys=e,this.mouseInput=r}if(r){let t=c.touchInput(this.canvas);this.ongoingTouches=t}}resize(){let t=this.canvas.clientWidth,e=this.canvas.clientHeight;this.canvas.width==t&&this.canvas.height==e||(this.canvas.width=t,this.canvas.height=e),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}draw(t){}started(){}render(t){if(this.deltaTime=t-this.lastFrame,this.lastFrame=t,this.resize(),this.draw(t),this.options.touchInput)for(let t in this.ongoingTouches)this.ongoingTouches[t].deltaX=0,this.ongoingTouches[t].deltaY=0;this.options.desktopInput&&(this.mouseInput.deltaX=0,this.mouseInput.deltaY=0,this.mouseInput.drag&&(this.mouseInput.dragX=0,this.mouseInput.dragY=0),this.mouseInput.wheelDeltaY=0),requestAnimationFrame(this.render.bind(this))}loadMesh(t){let e=new o.Mesh(t);return Object(o.initMeshBuffers)(this.gl,e),e}setMeshVAO(t,e){let n=this.gl.getAttribLocation(e.program,"a_position"),r=this.gl.getAttribLocation(e.program,"a_texCoord"),a=this.gl.getAttribLocation(e.program,"a_normal"),i=this.gl.createVertexArray();return this.gl.bindVertexArray(i),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.vertexBuffer),this.gl.vertexAttribPointer(n,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(n),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.textureBuffer),this.gl.vertexAttribPointer(r,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(r),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.normalBuffer),this.gl.vertexAttribPointer(a,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(a),this.gl.bindVertexArray(null),i}drawMesh(t,e){this.gl.bindVertexArray(e),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,t.indexBuffer.numItems,this.gl.UNSIGNED_SHORT,0),this.gl.bindVertexArray(null)}async start(){let t=await this.loadTexture();this.loadingBar.remove(),this.el.appendChild(this.canvas),this.render(this.lastFrame),this.textures=t,this.started()}setImageResource(t){this.resource.images=t}async loadTexture(){let t=[];this.resourceCount+=this.resource.images.length;let e=this.resource.images.map((t,e)=>c.loadImage(t,t=>{this.loadProgressProxy[e]=t})),n=await Promise.all(e);return this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),n.forEach((e,n)=>{t[n]=this.gl.createTexture(),this.gl.activeTexture(this.gl.TEXTURE0+n),this.gl.bindTexture(this.gl.TEXTURE_2D,t[n]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR)}),t}}c.loadImage=function(t,e){return new Promise((n,r)=>{let a=new XMLHttpRequest,i=!1;a.open("GET",t,!0),a.responseType="arraybuffer",a.onprogress=function(t){t.lengthComputable?e(Math.round(t.loaded/t.total*100)):i||(i=!0,e(-1))},a.onloadend=function(){if(a.status.toString().match(/^2/)){i||e(100);let t={},r=a.getAllResponseHeaders().match(/^Content-Type\:\s*(.*?)$/im);r&&r[1]&&(t.type=r[1]);let s=new Blob([this.response],t),o=window.URL.createObjectURL(s),u=new Image;u.src=o,u.onload=(()=>n(u))}else r(a)},a.send()})},(s=c).desktopInput=function(t,e){let n=new Map,r={deltaX:0,deltaY:0,wheelDeltaY:0};function a(t){n.set(t.key,!0)}function i(t){n.set(t.key,!1)}function s(t){r.deltaX=t.movementX||0,r.deltaY=t.movementY||0,r.drag&&(r.dragX=t.movementX||0,r.dragY=t.movementY||0)}function o(t){r.wheelDeltaY=t.wheelDeltaY}function u(t){r.drag=!0,r.dragX=0,r.dragY=0}function l(t){r.drag=!1}function c(){document.addEventListener("keydown",a),document.addEventListener("keyup",i),document.addEventListener("mousemove",s),document.addEventListener("mousedown",u),document.addEventListener("mouseup",l),document.addEventListener("wheel",o)}function h(){document.removeEventListener("keydown",a),document.removeEventListener("keyup",i),document.removeEventListener("mousemove",s),document.removeEventListener("mousedown",u),document.removeEventListener("mouseup",l),document.removeEventListener("wheel",o)}if(e.lockPointer){function f(){document.pointerLockElement===t||document.mozPointerLockElement===t?c():h()}t.requestPointerLock=t.requestPointerLock||t.mozRequestPointerLock,t.exitPointerLock=t.exitPointerLock||t.mozExitPointerLock,t.onclick=function(){t.requestPointerLock()},document.addEventListener("pointerlockchange",f,!1),document.addEventListener("mozpointerlockchange",f,!1)}else t.contentEditable="true",t.style.cursor="default",t.addEventListener("focus",c),t.addEventListener("blur",h);return[n,r]},s.touchInput=function(t){const e=[];function n(t){for(let n=0;n<e.length;n++)if(e[n].identifier===t)return n;return-1}return t.addEventListener("touchstart",function(t){t.preventDefault();let n=t.changedTouches;for(let t=0;t<n.length;t++){let r={pageX:n[t].pageX,pageY:n[t].pageY,startX:n[t].pageX,startY:n[t].pageY,deltaX:0,deltaY:0,identifier:n[t].identifier};e.push(r)}},!1),t.addEventListener("touchend",function(t){t.preventDefault();let r=t.changedTouches;for(let t=0;t<r.length;t++){let a=n(r[t].identifier);e.splice(a,1)}},!1),t.addEventListener("touchmove",function(t){t.preventDefault();let r=t.changedTouches;for(let t=0;t<r.length;t++){let a=n(r[t].identifier),i={pageX:r[t].pageX,pageY:r[t].pageY,startX:e[a].startX,startY:e[a].startY,deltaX:r[t].pageX-e[a].pageX,deltaY:r[t].pageY-e[a].pageY,identifier:r[t].identifier};e.splice(a,1,i)}},!1),e},function(t){const e=[-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0],n="#version 300 es\n\n  layout (location = 0) in vec3 a_position;\n  layout (location = 1) in vec2 a_texCoord;\n\n  out vec2 TexCoord;\n\n  void main()\n  {\n      TexCoord = a_texCoord;\n      gl_Position = vec4(a_position, 1.0);\n  }\n  ";t.prototype.drawQuad=function(t){if(void 0===this.quadVAO){this.quadVAO=this.gl.createVertexArray();let t=this.gl.createBuffer();this.gl.bindVertexArray(this.quadVAO),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.const_DRAW),this.gl.enableVertexAttribArray(0),this.gl.vertexAttribPointer(0,3,this.gl.FLOAT,!0,20,0),this.gl.enableVertexAttribArray(1),this.gl.vertexAttribPointer(1,2,this.gl.FLOAT,!0,20,12),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.gl.bindVertexArray(null)}if(this.gl.bindVertexArray(this.quadVAO),1===t.length)this.gl.bindTexture(this.gl.TEXTURE_2D,t[0]);else for(let e in t)this.gl.activeTexture(this.gl.TEXTURE0+Number(e)),this.gl.bindTexture(this.gl.TEXTURE_2D,t[e]);this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.gl.bindVertexArray(null)},t.prototype.drawFB=function(t){void 0===this.fbShader&&(this.fbShader=new u(this.gl,n,"#version 300 es\n\n  precision mediump float;\n\n  out vec4 FragColor;\n  in vec2 TexCoord;\n\n  uniform sampler2D scene;\n\n  void main()\n  {\n    FragColor = texture(scene, TexCoord);\n  }\n  ")),this.fbShader.use(),this.fbShader.setInt("scene",0),this.drawQuad([t])},t.prototype.drawDepth=function(t){void 0===this.fbShader&&(this.fbShader=new u(this.gl,n,"#version 300 es\n\n  precision mediump float;\n\n  out vec4 FragColor;\n  in vec2 TexCoord;\n\n  uniform sampler2D depthMap;\n\n  void main()\n  {\n    float depthValue = texture(depthMap, TexCoord).r;\n    FragColor = vec4(vec3(depthValue), 1.0);\n  }\n  ")),this.fbShader.use(),this.fbShader.setInt("depthMap",0),this.drawQuad([t])}}(c);var h=c;const f=1e-6;let d="undefined"!=typeof Float32Array?Float32Array:Array;const p=Math.random;function m(){let t=new d(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function M(t){let e=new d(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function v(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function g(t,e,n,r,a,i,s,o,u,l,c,h,f,p,m,M){let v=new d(16);return v[0]=t,v[1]=e,v[2]=n,v[3]=r,v[4]=a,v[5]=i,v[6]=s,v[7]=o,v[8]=u,v[9]=l,v[10]=c,v[11]=h,v[12]=f,v[13]=p,v[14]=m,v[15]=M,v}function b(t,e,n,r,a,i,s,o,u,l,c,h,f,d,p,m,M){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t[4]=i,t[5]=s,t[6]=o,t[7]=u,t[8]=l,t[9]=c,t[10]=h,t[11]=f,t[12]=d,t[13]=p,t[14]=m,t[15]=M,t}function y(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function x(t,e){if(t===e){let n=e[1],r=e[2],a=e[3],i=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=a,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function w(t,e){let n=e[0],r=e[1],a=e[2],i=e[3],s=e[4],o=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],M=e[14],v=e[15],g=n*o-r*s,b=n*u-a*s,y=n*l-i*s,x=r*u-a*o,w=r*l-i*o,A=a*l-i*u,T=c*m-h*p,E=c*M-f*p,I=c*v-d*p,k=h*M-f*m,_=h*v-d*m,L=f*v-d*M,R=g*L-b*_+y*k+x*I-w*E+A*T;return R?(R=1/R,t[0]=(o*L-u*_+l*k)*R,t[1]=(a*_-r*L-i*k)*R,t[2]=(m*A-M*w+v*x)*R,t[3]=(f*w-h*A-d*x)*R,t[4]=(u*I-s*L-l*E)*R,t[5]=(n*L-a*I+i*E)*R,t[6]=(M*y-p*A-v*b)*R,t[7]=(c*A-f*y+d*b)*R,t[8]=(s*_-o*I+l*T)*R,t[9]=(r*I-n*_-i*T)*R,t[10]=(p*w-m*y+v*g)*R,t[11]=(h*y-c*w-d*g)*R,t[12]=(o*E-s*k-u*T)*R,t[13]=(n*k-r*E+a*T)*R,t[14]=(m*b-p*x-M*g)*R,t[15]=(c*x-h*b+f*g)*R,t):null}function A(t,e){let n=e[0],r=e[1],a=e[2],i=e[3],s=e[4],o=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],m=e[13],M=e[14],v=e[15];return t[0]=o*(f*v-d*M)-h*(u*v-l*M)+m*(u*d-l*f),t[1]=-(r*(f*v-d*M)-h*(a*v-i*M)+m*(a*d-i*f)),t[2]=r*(u*v-l*M)-o*(a*v-i*M)+m*(a*l-i*u),t[3]=-(r*(u*d-l*f)-o*(a*d-i*f)+h*(a*l-i*u)),t[4]=-(s*(f*v-d*M)-c*(u*v-l*M)+p*(u*d-l*f)),t[5]=n*(f*v-d*M)-c*(a*v-i*M)+p*(a*d-i*f),t[6]=-(n*(u*v-l*M)-s*(a*v-i*M)+p*(a*l-i*u)),t[7]=n*(u*d-l*f)-s*(a*d-i*f)+c*(a*l-i*u),t[8]=s*(h*v-d*m)-c*(o*v-l*m)+p*(o*d-l*h),t[9]=-(n*(h*v-d*m)-c*(r*v-i*m)+p*(r*d-i*h)),t[10]=n*(o*v-l*m)-s*(r*v-i*m)+p*(r*l-i*o),t[11]=-(n*(o*d-l*h)-s*(r*d-i*h)+c*(r*l-i*o)),t[12]=-(s*(h*M-f*m)-c*(o*M-u*m)+p*(o*f-u*h)),t[13]=n*(h*M-f*m)-c*(r*M-a*m)+p*(r*f-a*h),t[14]=-(n*(o*M-u*m)-s*(r*M-a*m)+p*(r*u-a*o)),t[15]=n*(o*f-u*h)-s*(r*f-a*h)+c*(r*u-a*o),t}function T(t){let e=t[0],n=t[1],r=t[2],a=t[3],i=t[4],s=t[5],o=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11],d=t[12],p=t[13],m=t[14],M=t[15];return(e*s-n*i)*(h*M-f*m)-(e*o-r*i)*(c*M-f*p)+(e*u-a*i)*(c*m-h*p)+(n*o-r*s)*(l*M-f*d)-(n*u-a*s)*(l*m-h*d)+(r*u-a*o)*(l*p-c*d)}function E(t,e,n){let r=e[0],a=e[1],i=e[2],s=e[3],o=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],m=e[12],M=e[13],v=e[14],g=e[15],b=n[0],y=n[1],x=n[2],w=n[3];return t[0]=b*r+y*o+x*h+w*m,t[1]=b*a+y*u+x*f+w*M,t[2]=b*i+y*l+x*d+w*v,t[3]=b*s+y*c+x*p+w*g,b=n[4],y=n[5],x=n[6],w=n[7],t[4]=b*r+y*o+x*h+w*m,t[5]=b*a+y*u+x*f+w*M,t[6]=b*i+y*l+x*d+w*v,t[7]=b*s+y*c+x*p+w*g,b=n[8],y=n[9],x=n[10],w=n[11],t[8]=b*r+y*o+x*h+w*m,t[9]=b*a+y*u+x*f+w*M,t[10]=b*i+y*l+x*d+w*v,t[11]=b*s+y*c+x*p+w*g,b=n[12],y=n[13],x=n[14],w=n[15],t[12]=b*r+y*o+x*h+w*m,t[13]=b*a+y*u+x*f+w*M,t[14]=b*i+y*l+x*d+w*v,t[15]=b*s+y*c+x*p+w*g,t}function I(t,e,n){let r,a,i,s,o,u,l,c,h,f,d,p,m=n[0],M=n[1],v=n[2];return e===t?(t[12]=e[0]*m+e[4]*M+e[8]*v+e[12],t[13]=e[1]*m+e[5]*M+e[9]*v+e[13],t[14]=e[2]*m+e[6]*M+e[10]*v+e[14],t[15]=e[3]*m+e[7]*M+e[11]*v+e[15]):(r=e[0],a=e[1],i=e[2],s=e[3],o=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=r,t[1]=a,t[2]=i,t[3]=s,t[4]=o,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=r*m+o*M+h*v+e[12],t[13]=a*m+u*M+f*v+e[13],t[14]=i*m+l*M+d*v+e[14],t[15]=s*m+c*M+p*v+e[15]),t}function k(t,e,n){let r=n[0],a=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function _(t,e,n,r){let a,i,s,o,u,l,c,h,d,p,m,M,v,g,b,y,x,w,A,T,E,I,k,_,L=r[0],R=r[1],S=r[2],F=Math.sqrt(L*L+R*R+S*S);return F<f?null:(L*=F=1/F,R*=F,S*=F,a=Math.sin(n),s=1-(i=Math.cos(n)),o=e[0],u=e[1],l=e[2],c=e[3],h=e[4],d=e[5],p=e[6],m=e[7],M=e[8],v=e[9],g=e[10],b=e[11],y=L*L*s+i,x=R*L*s+S*a,w=S*L*s-R*a,A=L*R*s-S*a,T=R*R*s+i,E=S*R*s+L*a,I=L*S*s+R*a,k=R*S*s-L*a,_=S*S*s+i,t[0]=o*y+h*x+M*w,t[1]=u*y+d*x+v*w,t[2]=l*y+p*x+g*w,t[3]=c*y+m*x+b*w,t[4]=o*A+h*T+M*E,t[5]=u*A+d*T+v*E,t[6]=l*A+p*T+g*E,t[7]=c*A+m*T+b*E,t[8]=o*I+h*k+M*_,t[9]=u*I+d*k+v*_,t[10]=l*I+p*k+g*_,t[11]=c*I+m*k+b*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function L(t,e,n){let r=Math.sin(n),a=Math.cos(n),i=e[4],s=e[5],o=e[6],u=e[7],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*a+l*r,t[5]=s*a+c*r,t[6]=o*a+h*r,t[7]=u*a+f*r,t[8]=l*a-i*r,t[9]=c*a-s*r,t[10]=h*a-o*r,t[11]=f*a-u*r,t}function R(t,e,n){let r=Math.sin(n),a=Math.cos(n),i=e[0],s=e[1],o=e[2],u=e[3],l=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a-l*r,t[1]=s*a-c*r,t[2]=o*a-h*r,t[3]=u*a-f*r,t[8]=i*r+l*a,t[9]=s*r+c*a,t[10]=o*r+h*a,t[11]=u*r+f*a,t}function S(t,e,n){let r=Math.sin(n),a=Math.cos(n),i=e[0],s=e[1],o=e[2],u=e[3],l=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*a+l*r,t[1]=s*a+c*r,t[2]=o*a+h*r,t[3]=u*a+f*r,t[4]=l*a-i*r,t[5]=c*a-s*r,t[6]=h*a-o*r,t[7]=f*a-u*r,t}function F(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function P(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function O(t,e,n){let r,a,i,s=n[0],o=n[1],u=n[2],l=Math.sqrt(s*s+o*o+u*u);return l<f?null:(s*=l=1/l,o*=l,u*=l,r=Math.sin(e),i=1-(a=Math.cos(e)),t[0]=s*s*i+a,t[1]=o*s*i+u*r,t[2]=u*s*i-o*r,t[3]=0,t[4]=s*o*i-u*r,t[5]=o*o*i+a,t[6]=u*o*i+s*r,t[7]=0,t[8]=s*u*i+o*r,t[9]=o*u*i-s*r,t[10]=u*u*i+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function B(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function D(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,e){let n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function U(t,e,n){let r=e[0],a=e[1],i=e[2],s=e[3],o=r+r,u=a+a,l=i+i,c=r*o,h=r*u,f=r*l,d=a*u,p=a*l,m=i*l,M=s*o,v=s*u,g=s*l;return t[0]=1-(d+m),t[1]=h+g,t[2]=f-v,t[3]=0,t[4]=h-g,t[5]=1-(c+m),t[6]=p+M,t[7]=0,t[8]=f+v,t[9]=p-M,t[10]=1-(c+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function C(t,e){let n=new d(3),r=-e[0],a=-e[1],i=-e[2],s=e[3],o=e[4],u=e[5],l=e[6],c=e[7],h=r*r+a*a+i*i+s*s;return h>0?(n[0]=2*(o*s+c*r+u*i-l*a)/h,n[1]=2*(u*s+c*a+l*r-o*i)/h,n[2]=2*(l*s+c*i+o*a-u*r)/h):(n[0]=2*(o*s+c*r+u*i-l*a),n[1]=2*(u*s+c*a+l*r-o*i),n[2]=2*(l*s+c*i+o*a-u*r)),U(t,e,n),t}function q(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function z(t,e){let n=e[0],r=e[1],a=e[2],i=e[4],s=e[5],o=e[6],u=e[8],l=e[9],c=e[10];return t[0]=Math.sqrt(n*n+r*r+a*a),t[1]=Math.sqrt(i*i+s*s+o*o),t[2]=Math.sqrt(u*u+l*l+c*c),t}function Y(t,e){let n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t}function X(t,e,n,r){let a=e[0],i=e[1],s=e[2],o=e[3],u=a+a,l=i+i,c=s+s,h=a*u,f=a*l,d=a*c,p=i*l,m=i*c,M=s*c,v=o*u,g=o*l,b=o*c,y=r[0],x=r[1],w=r[2];return t[0]=(1-(p+M))*y,t[1]=(f+b)*y,t[2]=(d-g)*y,t[3]=0,t[4]=(f-b)*x,t[5]=(1-(h+M))*x,t[6]=(m+v)*x,t[7]=0,t[8]=(d+g)*w,t[9]=(m-v)*w,t[10]=(1-(h+p))*w,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function V(t,e,n,r,a){let i=e[0],s=e[1],o=e[2],u=e[3],l=i+i,c=s+s,h=o+o,f=i*l,d=i*c,p=i*h,m=s*c,M=s*h,v=o*h,g=u*l,b=u*c,y=u*h,x=r[0],w=r[1],A=r[2],T=a[0],E=a[1],I=a[2],k=(1-(m+v))*x,_=(d+y)*x,L=(p-b)*x,R=(d-y)*w,S=(1-(f+v))*w,F=(M+g)*w,P=(p+b)*A,O=(M-g)*A,B=(1-(f+m))*A;return t[0]=k,t[1]=_,t[2]=L,t[3]=0,t[4]=R,t[5]=S,t[6]=F,t[7]=0,t[8]=P,t[9]=O,t[10]=B,t[11]=0,t[12]=n[0]+T-(k*T+R*E+P*I),t[13]=n[1]+E-(_*T+S*E+O*I),t[14]=n[2]+I-(L*T+F*E+B*I),t[15]=1,t}function j(t,e){let n=e[0],r=e[1],a=e[2],i=e[3],s=n+n,o=r+r,u=a+a,l=n*s,c=r*s,h=r*o,f=a*s,d=a*o,p=a*u,m=i*s,M=i*o,v=i*u;return t[0]=1-h-p,t[1]=c+v,t[2]=f-M,t[3]=0,t[4]=c-v,t[5]=1-l-p,t[6]=d+m,t[7]=0,t[8]=f+M,t[9]=d-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function W(t,e,n,r,a,i,s){let o=1/(n-e),u=1/(a-r),l=1/(i-s);return t[0]=2*i*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(a+r)*u,t[10]=(s+i)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i*2*l,t[15]=0,t}function H(t,e,n,r,a){let i=1/Math.tan(e/2),s=1/(r-a);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+r)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*r*s,t[15]=0,t}function G(t,e,n,r){let a=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+o),l=2/(a+i);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(s-o)*u*.5,t[9]=(a-i)*l*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function K(t,e,n,r,a,i,s){let o=1/(e-n),u=1/(r-a),l=1/(i-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*o,t[13]=(a+r)*u,t[14]=(s+i)*l,t[15]=1,t}function Q(t,e,n,r){let a,i,s,o,u,l,c,h,d,p,m=e[0],M=e[1],v=e[2],g=r[0],b=r[1],x=r[2],w=n[0],A=n[1],T=n[2];return Math.abs(m-w)<f&&Math.abs(M-A)<f&&Math.abs(v-T)<f?y(t):(c=m-w,h=M-A,d=v-T,a=b*(d*=p=1/Math.sqrt(c*c+h*h+d*d))-x*(h*=p),i=x*(c*=p)-g*d,s=g*h-b*c,(p=Math.sqrt(a*a+i*i+s*s))?(a*=p=1/p,i*=p,s*=p):(a=0,i=0,s=0),o=h*s-d*i,u=d*a-c*s,l=c*i-h*a,(p=Math.sqrt(o*o+u*u+l*l))?(o*=p=1/p,u*=p,l*=p):(o=0,u=0,l=0),t[0]=a,t[1]=o,t[2]=c,t[3]=0,t[4]=i,t[5]=u,t[6]=h,t[7]=0,t[8]=s,t[9]=l,t[10]=d,t[11]=0,t[12]=-(a*m+i*M+s*v),t[13]=-(o*m+u*M+l*v),t[14]=-(c*m+h*M+d*v),t[15]=1,t)}function Z(t,e,n,r){let a=e[0],i=e[1],s=e[2],o=r[0],u=r[1],l=r[2],c=a-n[0],h=i-n[1],f=s-n[2],d=c*c+h*h+f*f;d>0&&(c*=d=1/Math.sqrt(d),h*=d,f*=d);let p=u*f-l*h,m=l*c-o*f,M=o*h-u*c;return(d=p*p+m*m+M*M)>0&&(p*=d=1/Math.sqrt(d),m*=d,M*=d),t[0]=p,t[1]=m,t[2]=M,t[3]=0,t[4]=h*M-f*m,t[5]=f*p-c*M,t[6]=c*m-h*p,t[7]=0,t[8]=c,t[9]=h,t[10]=f,t[11]=0,t[12]=a,t[13]=i,t[14]=s,t[15]=1,t}function $(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function J(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function tt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function et(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function nt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function rt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function at(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function it(t,e){let n=t[0],r=t[1],a=t[2],i=t[3],s=t[4],o=t[5],u=t[6],l=t[7],c=t[8],h=t[9],d=t[10],p=t[11],m=t[12],M=t[13],v=t[14],g=t[15],b=e[0],y=e[1],x=e[2],w=e[3],A=e[4],T=e[5],E=e[6],I=e[7],k=e[8],_=e[9],L=e[10],R=e[11],S=e[12],F=e[13],P=e[14],O=e[15];return Math.abs(n-b)<=f*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-y)<=f*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(a-x)<=f*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(i-w)<=f*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-A)<=f*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(o-T)<=f*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(u-E)<=f*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(l-I)<=f*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(c-k)<=f*Math.max(1,Math.abs(c),Math.abs(k))&&Math.abs(h-_)<=f*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(d-L)<=f*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(p-R)<=f*Math.max(1,Math.abs(p),Math.abs(R))&&Math.abs(m-S)<=f*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(M-F)<=f*Math.max(1,Math.abs(M),Math.abs(F))&&Math.abs(v-P)<=f*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(g-O)<=f*Math.max(1,Math.abs(g),Math.abs(O))}Math.PI;const st=E,ot=et;function ut(){let t=new d(3);return t[0]=0,t[1]=0,t[2]=0,t}function lt(t){var e=new d(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function ct(t){let e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function ht(t,e,n){let r=new d(3);return r[0]=t,r[1]=e,r[2]=n,r}function ft(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function dt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function pt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function mt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Mt(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function vt(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function gt(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function bt(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function yt(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function xt(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function wt(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function At(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Tt(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Et(t,e){let n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return Math.sqrt(n*n+r*r+a*a)}function It(t,e){let n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];return n*n+r*r+a*a}function kt(t){let e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function _t(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Lt(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Rt(t,e){let n=e[0],r=e[1],a=e[2],i=n*n+r*r+a*a;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t}function St(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ft(t,e,n){let r=e[0],a=e[1],i=e[2],s=n[0],o=n[1],u=n[2];return t[0]=a*u-i*o,t[1]=i*s-r*u,t[2]=r*o-a*s,t}function Pt(t,e,n,r){let a=e[0],i=e[1],s=e[2];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=s+r*(n[2]-s),t}function Ot(t,e,n,r,a,i){let s=i*i,o=s*(2*i-3)+1,u=s*(i-2)+i,l=s*(i-1),c=s*(3-2*i);return t[0]=e[0]*o+n[0]*u+r[0]*l+a[0]*c,t[1]=e[1]*o+n[1]*u+r[1]*l+a[1]*c,t[2]=e[2]*o+n[2]*u+r[2]*l+a[2]*c,t}function Bt(t,e,n,r,a,i){let s=1-i,o=s*s,u=i*i,l=o*s,c=3*i*o,h=3*u*s,f=u*i;return t[0]=e[0]*l+n[0]*c+r[0]*h+a[0]*f,t[1]=e[1]*l+n[1]*c+r[1]*h+a[1]*f,t[2]=e[2]*l+n[2]*c+r[2]*h+a[2]*f,t}function Dt(t,e){e=e||1;let n=2*p()*Math.PI,r=2*p()-1,a=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=r*e,t}function Nt(t,e,n){let r=e[0],a=e[1],i=e[2],s=n[3]*r+n[7]*a+n[11]*i+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*a+n[8]*i+n[12])/s,t[1]=(n[1]*r+n[5]*a+n[9]*i+n[13])/s,t[2]=(n[2]*r+n[6]*a+n[10]*i+n[14])/s,t}function Ut(t,e,n){let r=e[0],a=e[1],i=e[2];return t[0]=r*n[0]+a*n[3]+i*n[6],t[1]=r*n[1]+a*n[4]+i*n[7],t[2]=r*n[2]+a*n[5]+i*n[8],t}function Ct(t,e,n){let r=n[0],a=n[1],i=n[2],s=n[3],o=e[0],u=e[1],l=e[2],c=a*l-i*u,h=i*o-r*l,f=r*u-a*o,d=a*f-i*h,p=i*c-r*f,m=r*h-a*c,M=2*s;return c*=M,h*=M,f*=M,d*=2,p*=2,m*=2,t[0]=o+c+d,t[1]=u+h+p,t[2]=l+f+m,t}function qt(t,e,n,r){let a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0],i[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),i[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function zt(t,e,n,r){let a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),i[1]=a[1],i[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Yt(t,e,n,r){let a=[],i=[];return a[0]=e[0]-n[0],a[1]=e[1]-n[1],a[2]=e[2]-n[2],i[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),i[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),i[2]=a[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Xt(t,e){let n=ht(t[0],t[1],t[2]),r=ht(e[0],e[1],e[2]);Rt(n,n),Rt(r,r);let a=St(n,r);return a>1?0:a<-1?Math.PI:Math.acos(a)}function Vt(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function jt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Wt(t,e){let n=t[0],r=t[1],a=t[2],i=e[0],s=e[1],o=e[2];return Math.abs(n-i)<=f*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-s)<=f*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(a-o)<=f*Math.max(1,Math.abs(a),Math.abs(o))}const Ht=mt,Gt=Mt,Kt=vt,Qt=Et,Zt=It,$t=ct,Jt=kt,te=function(){let t=ut();return function(e,n,r,a,i,s){let o,u;for(n||(n=3),r||(r=0),u=a?Math.min(a*n+r,e.length):e.length,o=r;o<u;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],i(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}();function ee(){let t=new d(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ne(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function re(t,e,n){n*=.5;let r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ae(t,e){let n=2*Math.acos(e[3]),r=Math.sin(n/2);return 0!=r?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function ie(t,e,n){let r=e[0],a=e[1],i=e[2],s=e[3],o=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*c+s*o+a*l-i*u,t[1]=a*c+s*u+i*o-r*l,t[2]=i*c+s*l+r*u-a*o,t[3]=s*c-r*o-a*u-i*l,t}function se(t,e,n){n*=.5;let r=e[0],a=e[1],i=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*o,t[1]=a*u+i*o,t[2]=i*u-a*o,t[3]=s*u-r*o,t}function oe(t,e,n){n*=.5;let r=e[0],a=e[1],i=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u-i*o,t[1]=a*u+s*o,t[2]=i*u+r*o,t[3]=s*u-a*o,t}function ue(t,e,n){n*=.5;let r=e[0],a=e[1],i=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*o,t[1]=a*u-r*o,t[2]=i*u+s*o,t[3]=s*u-i*o,t}function le(t,e){let n=e[0],r=e[1],a=e[2];return t[0]=n,t[1]=r,t[2]=a,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),t}function ce(t,e,n,r){let a,i,s,o,u,l=e[0],c=e[1],h=e[2],f=e[3],d=n[0],p=n[1],m=n[2],M=n[3];return(i=l*d+c*p+h*m+f*M)<0&&(i=-i,d=-d,p=-p,m=-m,M=-M),1-i>1e-6?(a=Math.acos(i),s=Math.sin(a),o=Math.sin((1-r)*a)/s,u=Math.sin(r*a)/s):(o=1-r,u=r),t[0]=o*l+u*d,t[1]=o*c+u*p,t[2]=o*h+u*m,t[3]=o*f+u*M,t}function he(t,e){let n=e[0],r=e[1],a=e[2],i=e[3],s=n*n+r*r+a*a+i*i,o=s?1/s:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-a*o,t[3]=i*o,t}function fe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function de(t,e){let n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);let a=(r+1)%3,i=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*a+a]-e[3*i+i]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*a+i]-e[3*i+a])*n,t[a]=(e[3*a+r]+e[3*r+a])*n,t[i]=(e[3*i+r]+e[3*r+i])*n}return t}function pe(t,e,n,r){let a=.5*Math.PI/180;e*=a,n*=a,r*=a;let i=Math.sin(e),s=Math.cos(e),o=Math.sin(n),u=Math.cos(n),l=Math.sin(r),c=Math.cos(r);return t[0]=i*u*c-s*o*l,t[1]=s*o*c+i*u*l,t[2]=s*u*l-i*o*c,t[3]=s*u*c+i*o*l,t}function me(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}!function(){let t=new d(4);t[0]=0,t[1]=0,t[2]=0,t[3]=0}();const Me=function(t){let e=new d(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ve=function(t,e,n,r){let a=new d(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=r,a},ge=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},be=function(t,e,n,r,a){return t[0]=e,t[1]=n,t[2]=r,t[3]=a,t},ye=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},xe=ie,we=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},Ae=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},Te=function(t,e,n,r){let a=e[0],i=e[1],s=e[2],o=e[3];return t[0]=a+r*(n[0]-a),t[1]=i+r*(n[1]-i),t[2]=s+r*(n[2]-s),t[3]=o+r*(n[3]-o),t},Ee=function(t){let e=t[0],n=t[1],r=t[2],a=t[3];return Math.sqrt(e*e+n*n+r*r+a*a)},Ie=Ee,ke=function(t){let e=t[0],n=t[1],r=t[2],a=t[3];return e*e+n*n+r*r+a*a},_e=ke,Le=function(t,e){let n=e[0],r=e[1],a=e[2],i=e[3],s=n*n+r*r+a*a+i*i;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=r*s,t[2]=a*s,t[3]=i*s),t},Re=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},Se=function(t,e){let n=t[0],r=t[1],a=t[2],i=t[3],s=e[0],o=e[1],u=e[2],l=e[3];return Math.abs(n-s)<=f*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-o)<=f*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(a-u)<=f*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(i-l)<=f*Math.max(1,Math.abs(i),Math.abs(l))},Fe=function(){let t=ut(),e=ht(1,0,0),n=ht(0,1,0);return function(r,a,i){let s=St(a,i);return s<-.999999?(Ft(t,e,a),$t(t)<1e-6&&Ft(t,n,a),Rt(t,t),re(r,t,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Ft(t,a,i),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+s,Le(r,r))}}(),Pe=function(){let t=ee(),e=ee();return function(n,r,a,i,s,o){return ce(t,r,s,o),ce(e,a,i,o),ce(n,t,e,2*o*(1-o)),n}}(),Oe=function(){let t=function(){let t=new d(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}();return function(e,n,r,a){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],Le(e,de(e,t))}}();!function(){let t=new d(2);t[0]=0,t[1]=0}();var Be=class{constructor(t=[0,0,0],e=[0,0,0,1],n=45){this.position=t,this.orientation=e,this.zoom=n,this.update()}getViewMatrix(){this.update();let t=r.create(),e=[0,0,0];return a.add(e,this.position,this.front),r.lookAt(t,this.position,e,this.up),t}translate(t){a.add(this.position,this.position,t)}rotate(t,e){let n=i.create();i.setAxisAngle(n,e,t),i.mul(this.orientation,this.orientation,n),this.update()}yaw(t){this.rotate(t,this.up)}pitch(t){this.rotate(t,this.right)}roll(t){this.rotate(t,this.front)}update(){let t=r.create();r.fromQuat(t,this.orientation),this.right=[-t[0],-t[4],-t[8]],this.up=[t[1],t[5],t[9]],this.front=[t[2],t[6],t[10]]}processZoom(t){this.zoom>=1&&this.zoom<=45&&(this.zoom-=t/200),this.zoom<=1&&(this.zoom=1),this.zoom>=45&&(this.zoom=45)}};function De(t,e,n){let r=a.create(),i=a.create(),s=a.create();return a.normalize(e,e),a.scale(i,t,Math.cos(n)),a.cross(s,e,t),a.scale(s,s,Math.sin(n)),a.add(r,i,s),a.normalize(r,r),r}class Ne extends Be{processMove(t,e){let n=a.create();t==Ne.Movement.FORWARD&&(a.scale(n,this.front,e),this.translate(n)),t==Ne.Movement.BACKWARD&&(a.scale(n,this.front,-e),this.translate(n)),t==Ne.Movement.LEFT&&(a.scale(n,this.right,-e),this.translate(n)),t==Ne.Movement.RIGHT&&(a.scale(n,this.right,e),this.translate(n)),t==Ne.Movement.UP&&(a.scale(n,this.up,e),this.translate(n)),t==Ne.Movement.DOWN&&(a.scale(n,this.up,-e),this.translate(n))}desktopFreeMoveControl(t,e,n,r,a=["w","s","a","d"," ","Shift","q","e"]){t.get(a[0])&&this.processMove(Ne.Movement.FORWARD,e),t.get(a[1])&&this.processMove(Ne.Movement.BACKWARD,e),t.get(a[2])&&this.processMove(Ne.Movement.LEFT,e),t.get(a[3])&&this.processMove(Ne.Movement.RIGHT,e),t.get(a[4])&&this.processMove(Ne.Movement.UP,e),t.get(a[5])&&this.processMove(Ne.Movement.DOWN,e);let i=t=>t/180*Math.PI;t.get(a[6])&&this.roll(i(5*-e)),t.get(a[7])&&this.roll(i(5*e));let s=i(n.deltaX*r),o=i(n.deltaY*r);this.pitch(o),this.rotate(s,[0,1,0]),this.processZoom(n.wheelDeltaY)}}Ne.Movement={FORWARD:0,BACKWARD:1,LEFT:2,RIGHT:3,UP:4,DOWN:5};var Ue=Ne;n.d(e,"ArGL",function(){return h}),n.d(e,"Camera",function(){return Be}),n.d(e,"Shader",function(){return u}),n.d(e,"OrbitCamera",function(){return class extends Be{constructor(t=[0,0,5],e=[0,0,0],n=45){let r=a.create();a.sub(r,e,t),a.normalize(r,r);let s=[r[0],0,r[2]],o=[0,r[1],Math.sqrt(1-r[1]**2)],u=0===a.length(s)?0:a.angle([0,0,1],s);u=r[0]>0?-u:u;let l=0===a.length(o)?0:a.angle([0,0,1],o);l=r[1]>0?-l:l,console.log(r,u,l),console.log(s,o),super(t,i.create(),n),this.yaw(u),this.pitch(l),this.center=e,this.distance=a.distance(e,t)}processRotate(t,e){let n=a.create();a.scale(n,this.front,-1),n=De(n,[0,1,0],-t);let r=a.create();a.cross(r,this.up,n),n=De(n,r,-e),a.scale(n,n,this.distance),this.position=n,this.rotate(t,[0,1,0]),this.pitch(e)}orbitControl(t){if(t.mouseInput.drag){let e=t.mouseInput.dragX/t.canvas.clientWidth*Math.PI*2,n=t.mouseInput.dragY/t.canvas.clientHeight*Math.PI*2;this.processRotate(e,n)}this.processZoom(t.mouseInput.wheelDeltaY)}}}),n.d(e,"FreeMoveCamera",function(){return Ue}),e.default=h}])});